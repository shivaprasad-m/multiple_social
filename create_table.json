CREATE collection SENTIMENT;
CREATE OR REPLACE TABLE SENTIMENT.TWEETS (
    id SMALLINT NOT NULL
        GENERATED ALWAYS AS IDENTITY
        (START WITH 1
        INCREMENT BY 1
        CYCLE),
    TWEET VARCHAR(5000),
    SCREEN_NAME VARCHAR(255),
    LOCATION VARCHAR(255),
    SENTIMENT_SCORE INT,
    SENTIMENT_GROUP VARCHAR(255),
    TIMESTP TIMESTAMP,
    TIMESTAMP_MS VARCHAR(255),
    primary key (id)
);
CREATE OR REPLACE TRIGGER SENTIMENT.Tweets_sentiment
  BEFORE INSERT OR UPDATE ON SENTIMENT.Tweets
  REFERENCING NEW AS n OLD AS o
  FOR EACH ROW MODE Db2ROW
  BEGIN
    SET n.SENTIMENT_GROUP = CASE WHEN n.SENTIMENT_SCORE > 0 THEN 'positive'
                                 WHEN n.SENTIMENT_SCORE = 0   THEN 'neutral'
                                 WHEN n.SENTIMENT_SCORE < 0  THEN 'negative'      
    END;    
 END;